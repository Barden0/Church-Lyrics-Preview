<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Lyrics Lower Thirds</title>

<style>
  /* ===== GLOBAL ===== */
  html, body {
    margin: 0;
    padding: 0;
    background: transparent;
    font-family: Raleway, Arial, sans-serif;
    color: white;
    height: 100%;
  }

  /* ===== OUTPUT (CROP THIS IN OBS) ===== */
  #lower-third {
    position: fixed;
    bottom: 8%;
    width: 100%;
    text-align: center;
    pointer-events: none;
  }

  #current-verse {
    font-size: 48px;
    line-height: 1.3;
    padding: 0 5%;
    white-space: pre-line;
  }

  /* ===== CONTROL PANEL ===== */
  #control-panel {
    position: fixed;
    top: 10px;
    left: 10px;
    width: 380px;
    background: rgba(0,0,0,0.85);
    border-radius: 10px;
    padding: 12px;
    pointer-events: auto;
  }

  #controls button {
    margin: 4px;
    padding: 6px 10px;
    font-size: 14px;
    cursor: pointer;
  }

  .preview {
    margin-top: 10px;
    font-size: 14px;
    opacity: 0.85;
    white-space: pre-line;
  }

  #verse-list {
    max-height: 200px;
    overflow-y: auto;
    margin-top: 10px;
    border-top: 1px solid #444;
    padding-top: 8px;
  }

  .verse-item {
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
  }

  .verse-item:hover {
    background: rgba(255,255,255,0.1);
  }

  .active {
    background: rgba(255,255,255,0.25);
  }
</style>
</head>

<body>

<!-- ===== OUTPUT ===== -->
<div id="lower-third">
  <div id="current-verse"></div>
</div>

<!-- ===== CONTROL ===== -->
<div id="control-panel">
  <div id="controls">
    <button onclick="prevVerse()">⬅ Prev</button>
    <button onclick="nextVerse()">Next ➡</button>
  </div>

  <div class="preview">
    <strong>Previous:</strong>
    <div id="prev-preview"></div>
  </div>

  <div class="preview">
    <strong>Current:</strong>
    <div id="current-preview"></div>
  </div>

  <div class="preview">
    <strong>Next:</strong>
    <div id="next-preview"></div>
  </div>

  <div id="verse-list"></div>
</div>

<script>
let verses = [];
let index = 0;

/* ===== LOAD LYRICS ===== */
fetch("song-lyrics.txt")
  .then(r => r.text())
  .then(text => {
    verses = text.trim().split(/\n\s*\n/);
    render();
    buildVerseList();
  });

/* ===== RENDER ===== */
function render() {
  document.getElementById("current-verse").textContent =
    verses[index] || "";

  document.getElementById("prev-preview").textContent =
    verses[index - 1] || "";

  document.getElementById("current-preview").textContent =
    verses[index] || "";

  document.getElementById("next-preview").textContent =
    verses[index + 1] || "";

  highlightActive();
}

/* ===== NAVIGATION ===== */
function nextVerse() {
  if (index < verses.length - 1) {
    index++;
    render();
  }
}

function prevVerse() {
  if (index > 0) {
    index--;
    render();
  }
}

/* ===== JUMP LIST ===== */
function buildVerseList() {
  const list = document.getElementById("verse-list");
  list.innerHTML = "";

  verses.forEach((v, i) => {
    const div = document.createElement("div");
    div.className = "verse-item";
    div.textContent = `Verse ${i + 1}: ${v.split("\n")[0]}`;
    div.onclick = () => {
      index = i;
      render();
    };
    list.appendChild(div);
  });
}

function highlightActive() {
  document.querySelectorAll(".verse-item").forEach((el, i) => {
    el.classList.toggle("active", i === index);
  });
}
</script>

</body>
</html>
